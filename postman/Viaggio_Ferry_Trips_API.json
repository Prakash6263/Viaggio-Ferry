{
  "info": {
    "_postman_id": "viaggio-ferry-trips-api",
    "name": "Viaggio Ferry - Trips & Availabilities API",
    "description": "Complete CRUD API collection for Ferry Trip and Availability Management",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "item": [
    {
      "name": "Trips",
      "item": [
        {
          "name": "List Trips",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/trips?page=1&limit=10",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "Get list of all trips with pagination. Response includes fully populated ship details (name, IMO number, flag state, capacity arrays, etc.)."
          },
          "response": []
        },
        {
          "name": "Get Trip by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}"
              ]
            },
            "description": "Get specific trip details"
          },
          "response": []
        },
        {
          "name": "Create Trip",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"tripName\": \"Dubai to Muscat Express\",\n  \"tripCode\": \"DXB-MSC-001\",\n  \"ship\": \"{{ship_id}}\",\n  \"departurePort\": \"{{port_id}}\",\n  \"arrivalPort\": \"{{arrival_port_id}}\",\n  \"departureDateTime\": \"2024-03-15T10:00:00Z\",\n  \"arrivalDateTime\": \"2024-03-15T14:30:00Z\",\n  \"status\": \"SCHEDULED\",\n  \"bookingOpeningDate\": \"2024-02-15T00:00:00Z\",\n  \"bookingClosingDate\": \"2024-03-15T08:00:00Z\",\n  \"checkInOpeningDate\": \"2024-03-15T07:00:00Z\",\n  \"checkInClosingDate\": \"2024-03-15T09:30:00Z\",\n  \"boardingClosingDate\": \"2024-03-15T09:45:00Z\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/trips",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips"
              ]
            },
            "description": "Create a new ferry trip. Remaining seats are auto-calculated from the ship's cabin capacities. Do not include remainingPassengerSeats, remainingCargoSeats, or remainingVehicleSeats in the request."
          },
          "response": []
        },
        {
          "name": "Update Trip",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"tripName\": \"Dubai to Muscat Express - Updated\",\n  \"status\": \"ONGOING\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}"
              ]
            },
            "description": "Update trip details. Remaining seats cannot be manually updated - they are managed automatically via availability creation/deletion."
          },
          "response": []
        },
        {
          "name": "Delete Trip",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}"
              ]
            },
            "description": "Delete trip (soft delete)"
          },
          "response": []
        }
      ],
      "description": "Trip CRUD operations"
    },
    {
      "name": "Trip Availabilities",
      "item": [
        {
          "name": "List Availabilities",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities?page=1&limit=10",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "1"
                },
                {
                  "key": "limit",
                  "value": "10"
                }
              ]
            },
            "description": "List all availabilities for a trip"
          },
          "response": []
        },
        {
          "name": "Get Availability Summary",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities/summary",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities",
                "summary"
              ]
            },
            "description": "Get availability summary for trip"
          },
          "response": []
        },
        {
          "name": "Get Availability by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities/{{availability_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities",
                "{{availability_id}}"
              ]
            },
            "description": "Get specific availability details"
          },
          "response": []
        },
        {
          "name": "Create Availabilities - All Types",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"availabilities\": [\n    {\n      \"type\": \"passenger\",\n      \"cabins\": [\n        {\n          \"cabin\": \"{{passenger_cabin_id_1}}\",\n          \"seats\": 30\n        },\n        {\n          \"cabin\": \"{{passenger_cabin_id_2}}\",\n          \"seats\": 25\n        }\n      ]\n    },\n    {\n      \"type\": \"cargo\",\n      \"cabins\": [\n        {\n          \"cabin\": \"{{cargo_cabin_id_1}}\",\n          \"seats\": 50\n        }\n      ]\n    },\n    {\n      \"type\": \"vehicle\",\n      \"cabins\": [\n        {\n          \"cabin\": \"{{vehicle_cabin_id_1}}\",\n          \"seats\": 20\n        }\n      ]\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities"
              ]
            },
            "description": "Create all three types of availabilities in single request. Validates: (1) Each cabin allocation ≤ ship's cabin capacity, (2) Total allocation ≤ trip's remaining seats. Automatically deducts seats from trip's remaining."
          },
          "response": []
        },
        {
          "name": "Create Availability - Passenger Only",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"availabilities\": [\n    {\n      \"type\": \"passenger\",\n      \"cabins\": [\n        {\n          \"cabin\": \"{{passenger_cabin_id_1}}\",\n          \"seats\": 30\n        }\n      ]\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities"
              ]
            },
            "description": "Create passenger availability. Validates against ship's passenger cabin capacity and trip's remaining passenger seats. Example values must not exceed ship capacity."
          },
          "response": []
        },
        {
          "name": "Create Availability - Cargo Only",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"availabilities\": [\n    {\n      \"type\": \"cargo\",\n      \"cabins\": [\n        {\n          \"cabin\": \"{{cargo_cabin_id_1}}\",\n          \"seats\": 50\n        }\n      ]\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities"
              ]
            },
            "description": "Create cargo availability. Validates against ship's cargo cabin capacity and trip's remaining cargo seats."
          },
          "response": []
        },
        {
          "name": "Create Availability - Vehicle Only",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"availabilities\": [\n    {\n      \"type\": \"vehicle\",\n      \"cabins\": [\n        {\n          \"cabin\": \"{{vehicle_cabin_id_1}}\",\n          \"seats\": 20\n        }\n      ]\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities"
              ]
            },
            "description": "Create vehicle availability. Validates against ship's vehicle cabin capacity and trip's remaining vehicle seats."
          },
          "response": []
        },
        {
          "name": "Update Availability",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"cabins\": [\n    {\n      \"cabin\": \"{{cabin_id_1}}\",\n      \"seats\": 25,\n      \"allocatedSeats\": 10\n    },\n    {\n      \"cabin\": \"{{cabin_id_2}}\",\n      \"seats\": 18,\n      \"allocatedSeats\": 5\n    }\n  ],\n  \"allocatedAgent\": \"{{agent_id}}\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities/{{availability_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities",
                "{{availability_id}}"
              ]
            },
            "description": "Update availability record"
          },
          "response": []
        },
        {
          "name": "Delete Availability",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities/{{availability_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities",
                "{{availability_id}}"
              ]
            },
            "description": "Delete availability record"
          },
          "response": []
        }
      ],
      "description": "Trip availability management for passenger, cargo, and vehicle allocations"
    },
    {
      "name": "Agent Allocations",
      "item": [
        {
          "name": "Get Availability Summary for Allocation",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities/{{availability_id}}/agent-allocations/summary",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities",
                "{{availability_id}}",
                "agent-allocations",
                "summary"
              ]
            },
            "description": "Get summary of agent allocations for an availability"
          },
          "response": []
        },
        {
          "name": "List Agent Allocations",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities/{{availability_id}}/agent-allocations",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities",
                "{{availability_id}}",
                "agent-allocations"
              ]
            },
            "description": "List all agent allocations for an availability"
          },
          "response": []
        },
        {
          "name": "Get Agent Allocation by ID",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities/{{availability_id}}/agent-allocations/{{allocation_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities",
                "{{availability_id}}",
                "agent-allocations",
                "{{allocation_id}}"
              ]
            },
            "description": "Get specific agent allocation details"
          },
          "response": []
        },
        {
          "name": "Create Agent Allocation",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"agent\": \"{{agent_id}}\",\n  \"allocations\": [\n    {\n      \"type\": \"passenger\",\n      \"cabins\": [\n        {\n          \"cabin\": \"{{passenger_cabin_id_1}}\",\n          \"allocatedSeats\": 25\n        }\n      ]\n    },\n    {\n      \"type\": \"cargo\",\n      \"cabins\": [\n        {\n          \"cabin\": \"{{cargo_cabin_id_1}}\",\n          \"allocatedSeats\": 20\n        }\n      ]\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities/{{availability_id}}/agent-allocations",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities",
                "{{availability_id}}",
                "agent-allocations"
              ]
            },
            "description": "Create agent allocation record"
          },
          "response": []
        },
        {
          "name": "Update Agent Allocation",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              },
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"allocations\": [\n    {\n      \"type\": \"passenger\",\n      \"cabins\": [\n        {\n          \"cabin\": \"{{passenger_cabin_id_1}}\",\n          \"allocatedSeats\": 25\n        },\n        {\n          \"cabin\": \"{{passenger_cabin_id_2}}\",\n          \"allocatedSeats\": 15\n        }\n      ]\n    },\n    {\n      \"type\": \"cargo\",\n      \"cabins\": [\n        {\n          \"cabin\": \"{{cargo_cabin_id_1}}\",\n          \"allocatedSeats\": 20\n        }\n      ]\n    }\n  ]\n}"
            },
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities/{{availability_id}}/agent-allocations/{{allocation_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities",
                "{{availability_id}}",
                "agent-allocations",
                "{{allocation_id}}"
              ]
            },
            "description": "Update agent allocation quantities. Restores previous allocations and applies new ones."
          },
          "response": []
        },
        {
          "name": "Delete Agent Allocation",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Authorization",
                "value": "Bearer {{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/api/trips/{{trip_id}}/availabilities/{{availability_id}}/agent-allocations/{{allocation_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "api",
                "trips",
                "{{trip_id}}",
                "availabilities",
                "{{availability_id}}",
                "agent-allocations",
                "{{allocation_id}}"
              ]
            },
            "description": "Delete agent allocation and restore seats back to availability pool."
          },
          "response": []
        }
      ],
      "description": "Agent allocation management for distributing availability seats to travel agents"
    }
  ],
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:5000",
      "type": "string"
    },
    {
      "key": "token",
      "value": "",
      "type": "string"
    },
    {
      "key": "company_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "ship_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "port_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "arrival_port_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "promotion_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "trip_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "availability_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "passenger_cabin_id_1",
      "value": "",
      "type": "string"
    },
    {
      "key": "passenger_cabin_id_2",
      "value": "",
      "type": "string"
    },
    {
      "key": "cargo_cabin_id_1",
      "value": "",
      "type": "string"
    },
    {
      "key": "vehicle_cabin_id_1",
      "value": "",
      "type": "string"
    },
    {
      "key": "agent_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "allocation_id",
      "value": "",
      "type": "string"
    }
  ]
}
